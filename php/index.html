<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>QTRA: Test PHP API</title>
    <script src="http://code.jquery.com/jquery-2.1.4.min.js"></script>
    <script>
        function submitForm() {
            formData = {
                'username': $('#username').val(),
                'password': $('#password').val(),
                'qsk': $('#qsk').val(),
            }
            formData = { 'params': formData }
            formData = JSON.stringify(formData);
            // console.log(formData);

            $.ajax({
                type: "POST",
                url: "qtra_calculator_api.php",
                data: formData,
                success: function(data){
                    var expirydate = data.success.expirydate;
                    if (data.success === false) {
                        $(".message").text("Error: could not login");
                        $(".message").css("color", "red")
                    } else {
                        $(".message").text("Sucess: " + expirydate);
                        $(".message").css("color", "green")
                    }
                    console.log(data);
                },
                error: function(error, errorCode, errorMessage){
                    console.log(error);
                    console.log(errorCode);
                    console.log(errorMessage);
                    $(".message").text("Error ["+error.status+"]: " + error.statusText);
                    $(".message").css("color", "red")
                },
                dataType: "json",
                contentType : "application/json"
            });
        }
    </script>
</head>
<body onLoad="submitForm()">
    <h2>QTRA: Test PHP API</h2>
    <form id="myForm">
        <input type="text" name="username" id="username" value="bob">
        <br>
        <input type="password" name="password" id="password" value="bob">
        <br><br>
        <input type="button" value="Submit" onClick="submitForm()">
        <input type="hidden" name="qsk" id="qsk" value="cf4298e4674118e979e72d83a133ec04feb6cf5a">
        <br>
        <br>
        <div class="message"></div>
        <br>
    </form>
</body>
</html>